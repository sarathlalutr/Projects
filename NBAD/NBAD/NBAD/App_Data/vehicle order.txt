,CAST(dbo.udf_GetNumeric((SUBSTRING(VehicleNumber, LEN(LEFT(VehicleNumber, CHARINDEX ('(', VehicleNumber))) + 1, LEN(VehicleNumber) - LEN(LEFT(VehicleNumber,  CHARINDEX ('(', VehicleNumber))) - LEN(RIGHT(VehicleNumber, LEN(VehicleNumber) -  case when CHARINDEX (')', VehicleNumber)=0 then 1 else CHARINDEX (')', VehicleNumber) END)) - 1))) AS INT) as Number  






function


CREATE FUNCTION dbo.udf_GetNumeric
(@strAlphaNumeric VARCHAR(256))
RETURNS VARCHAR(256)
AS
BEGIN
DECLARE @intAlpha INT
SET @intAlpha = PATINDEX('%[^0-9]%', @strAlphaNumeric)
BEGIN
WHILE @intAlpha > 0
BEGIN
SET @strAlphaNumeric = STUFF(@strAlphaNumeric, @intAlpha, 1, '' )
SET @intAlpha = PATINDEX('%[^0-9]%', @strAlphaNumeric )
END
END
RETURN ISNULL(@strAlphaNumeric,0)
END
GO